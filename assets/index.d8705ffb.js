var U=Object.defineProperty,K=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var L=(t,e,s)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,b=(t,e)=>{for(var s in e||(e={}))q.call(e,s)&&L(t,s,e[s]);if(O)for(var s of O(e))G.call(e,s)&&L(t,s,e[s]);return t},T=(t,e)=>K(t,$(e));var C=(t,e,s)=>(L(t,typeof e!="symbol"?e+"":e,s),s);import{r as P,a as N,d as A,o as H,b as x,c as D,e as g,u as f,t as k,f as E,w as Y,v as j,g as J,p as Q,h as X,i as Z,j as tt,F as et,k as it}from"./vendor.8e5ed98f.js";const nt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))h(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&h(m)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerpolicy&&(c.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?c.credentials="include":i.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}};nt();const n=P({timeLimit:60,numberOfCats:5,speedOfCats:2,lightRadius:100,lightSpeed:20,lightColor:"#ffffff",gameStarted:!1,lastScore:null}),st={effect:t=>{n.lightRadius*=t},value:2,positive:!0,resetValue:.5,duration:5e3},ot={effect:t=>{n.lightSpeed*=t},value:2,positive:!0,resetValue:.5,duration:5e3},at={effect:()=>{var t;(t=u.value)==null||t.addCat()},value:1,positive:!0},rt={effect:t=>{var e;(e=u.value)==null||e.setTimeLimit(u.value.timeLimit-t)},value:3,positive:!0},lt={effect:t=>{n.lightRadius*=t},value:.5,positive:!1,resetValue:2,duration:5e3},ct={effect:t=>{n.lightSpeed*=t},value:.5,positive:!1,resetValue:2,duration:5e3},dt={effect:t=>{n.lightSpeed*=t},value:.001,positive:!1,resetValue:1e3,duration:500},V=[st,ot,at,rt,lt,ct,dt];function ut(t){t.effect(t.value),console.log(t.duration),t.duration&&(t.timeoutId=setTimeout(()=>{t.resetValue&&t.effect(t.resetValue),clearTimeout(t.timeoutId),t.timeoutId=void 0},t.duration))}function W(t){return t.x*t.x+t.y*t.y}function z(t,e){return W({x:e.x-t.x,y:e.y-t.y})}function ht(t,e,s){const h={x:e.x-t.position.x,y:e.y-t.position.y},i=W(h);if(i<s*s)t.position.x=e.x,t.position.y=e.y;else{const c=Math.sqrt(i);t.position.x+=s*h.x/c,t.position.y+=s*h.y/c}return t}function F(t){return t.target&&ht(t,t.target,t.getSpeed()),t}var p;(function(t){t.ALIVE="alive",t.DEAD="dead"})(p||(p={}));var v;(function(t){t.ALIVE_UNKNOWN="alive_unknown",t.DEAD_UNKNOWN="dead_unknown"})(v||(v={}));function gt(t){return t.schrodingerState===v.ALIVE_UNKNOWN?t.schrodingerState=p.ALIVE:t.schrodingerState===v.DEAD_UNKNOWN&&(t.schrodingerState=p.DEAD),t}function mt(t,e){return t.schrodingerState=e,t}const ft=new Audio("/src/assets/sweet-kitty.mp3"),pt=new Audio("/src/assets/space-impact.mp3"),R=new Audio("/src/assets/night-ambiance.mp3");R.volume=.15;R.loop=!0;function vt(t){return t.schrodingerState!==p.DEAD&&performance.now()>t.lastWitnessAlive+t.invulnerableTime&&mt(t,v.DEAD_UNKNOWN),t}function _t(t){return gt(t),t.schrodingerState===p.ALIVE&&(t.lastWitnessAlive=performance.now()),t}const I=new Image(62,59);I.src="/src/assets/eye.png";const w=new Image(355,256);w.src="/src/assets/cat.png";const M=new Image(62,59);M.src="/src/assets/eye_crossed.png";const yt=new Audio("/src/assets/positive-bonus.mp3"),xt=new Audio("/src/assets/negative-bonus.mp3"),Ct=new Audio("/src/assets/spawn-bonus.mp3"),Dt=new Audio("/src/assets/angry-kitty.mp3"),u=N(null);class St{constructor(e){C(this,"canvasRenderingContext2D");C(this,"canvasDimensions");C(this,"cats",[]);C(this,"bonuses",[]);C(this,"light");C(this,"startingTime");C(this,"timeLimit");this.canvasRenderingContext2D=e.canvasRenderingContext2D,this.canvasDimensions=e.canvasDimensions,this.startingTime=performance.now(),this.light={position:{x:.5*e.canvasDimensions.width,y:.5*e.canvasDimensions.height},target:{x:.5*e.canvasDimensions.width,y:.5*e.canvasDimensions.height},getRadius:()=>n.lightRadius,getSpeed:()=>n.lightSpeed},this.timeLimit=n.timeLimit,this.generateCats(n.numberOfCats)}setTimeLimit(e){this.timeLimit=e}generateCats(e){const s=[],h=performance.now();for(let i=0;i<e;++i)s.push({id:i,position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},sprite:"",size:50,schrodingerState:v.ALIVE_UNKNOWN,lastWitnessAlive:h,invulnerableTime:3e3+Math.random()*3e3,getSpeed:()=>n.speedOfCats,clock:h,internalClockReset:Math.random()*2e3+1e3});this.cats=s}addCat(){const e=performance.now();this.cats.push({id:this.cats.length,position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},sprite:"",size:50,schrodingerState:v.ALIVE_UNKNOWN,lastWitnessAlive:e,invulnerableTime:4e3+Math.random()*1e3,getSpeed:()=>n.speedOfCats,clock:e,internalClockReset:Math.random()*2e3+1e3})}moveCats(){const e=this.cats.filter(s=>s.schrodingerState!==p.DEAD);for(const s of e)F(s)}run(){const e=performance.now(),s=this.cats.filter(i=>i.schrodingerState===p.ALIVE||i.schrodingerState===v.ALIVE_UNKNOWN||i.schrodingerState===v.DEAD_UNKNOWN).length;if(n.gameStarted&&s===0||n.gameStarted&&n.timeLimit-(e-this.startingTime)/1e3<0){n.gameStarted=!1,R.pause(),R.currentTime=0,ft.play(),n.lastScore=this.cats.filter(i=>i.schrodingerState===p.ALIVE||i.schrodingerState===v.ALIVE_UNKNOWN).length;for(const i of this.bonuses)i.timeoutId&&i.resetValue&&(i.effect(i.resetValue),clearTimeout(i.timeoutId),i.timeoutId=void 0)}F(this.light);for(const i of this.cats)e>i.clock+i.internalClockReset&&(i.clock=e,i.target={x:Math.random()*this.canvasDimensions.width,y:Math.random()*this.canvasDimensions.height});const h=this.bonuses.filter(i=>!i.triggered);if(n.gameStarted){const i=this.light.getRadius(),c=i*i,m=this.cats.filter(d=>d.schrodingerState!==p.DEAD);for(const d of m)z(this.light.position,d.position)<c?(d.schrodingerState===v.DEAD_UNKNOWN&&Dt.play(),_t(d)):vt(d);for(const d of h)z(this.light.position,d.position)<c&&(d.positive?yt.play():xt.play(),ut(d),d.triggered=!0)}for(const i of h)e>i.clock+i.stayOnFieldDuration&&(i.triggered=!0);this.moveCats(),Math.random()<.002&&(n.gameStarted&&Ct.play(),this.bonuses.push(T(b({},V[Math.floor(Math.random()*V.length)]),{position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},clock:e,stayOnFieldDuration:3e3+2e3*Math.random(),triggered:!1}))),this.render()}moveLightTarget(e){this.light.target={x:e.x,y:e.y}}render(){const e=n.lightColor,s="rgb(0, 0, 0, 0.95)";this.canvasRenderingContext2D.fillStyle=e,this.canvasRenderingContext2D.fillRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height);const h=this.cats.filter(o=>o.schrodingerState===p.DEAD),i=this.cats.filter(o=>o.schrodingerState!==p.DEAD),c=this.bonuses.filter(o=>!o.triggered);for(const o of h){const r=o.size,a=w.width/w.height;this.canvasRenderingContext2D.drawImage(w,o.position.x-.5*r*a,o.position.y-.5*r,r*a,r);const l=.3*o.size;this.canvasRenderingContext2D.drawImage(M,o.position.x-l+.1*l,o.position.y-.1*o.size,l,l),this.canvasRenderingContext2D.drawImage(M,o.position.x+l-.7*l,o.position.y-.15*o.size,l,l)}for(const o of i){const r=o.size,a=w.width/w.height;this.canvasRenderingContext2D.drawImage(w,o.position.x-.5*r*a,o.position.y-.5*r,r*a,r)}for(const o of c)o.positive?this.canvasRenderingContext2D.fillStyle="green":this.canvasRenderingContext2D.fillStyle="orange",this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(o.position.x,o.position.y,20,0,2*Math.PI),this.canvasRenderingContext2D.fill();const m=this.light.position.x,d=this.light.position.y,_=this.light.getRadius();this.canvasRenderingContext2D.fillStyle=s,this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(m,d,.99*_,0,2*Math.PI),this.canvasRenderingContext2D.rect(this.canvasDimensions.width,0,-this.canvasDimensions.width,this.canvasDimensions.height),this.canvasRenderingContext2D.fill();const S=this.canvasRenderingContext2D.createRadialGradient(m,d,0,m,d,_);S.addColorStop(0,"rgba(0, 0, 0, 0)"),S.addColorStop(1,"rgba(0, 0, 0, 0.8)"),this.canvasRenderingContext2D.fillStyle=S,this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(m,d,_,0,2*Math.PI),this.canvasRenderingContext2D.fill(),this.canvasRenderingContext2D.font="30px Arial";for(const o of c)o.positive?this.canvasRenderingContext2D.fillStyle="lime":this.canvasRenderingContext2D.fillStyle="red",this.canvasRenderingContext2D.fillText("!",o.position.x-5,o.position.y+10);for(const o of i){const r=.3*o.size;this.canvasRenderingContext2D.drawImage(I,o.position.x-r+.1*r,o.position.y-.1*o.size,r,r),this.canvasRenderingContext2D.drawImage(I,o.position.x+r-.7*r,o.position.y-.15*o.size,r,r)}this.canvasRenderingContext2D.font="30px Arial",this.canvasRenderingContext2D.fillStyle="yellow",n.gameStarted?this.canvasRenderingContext2D.fillText(`Time: ${(n.timeLimit-(performance.now()-this.startingTime)/1e3).toFixed(1)}s`,5,30):this.canvasRenderingContext2D.fillText(`Time: ${n.timeLimit.toFixed(1)}s`,5,30)}}var B=(t,e)=>{for(const[s,h]of e)t[s]=h;return t};const wt=A({setup(t){const e=N(null);let s=null;const h=window.innerHeight,i=window.innerWidth;H(()=>{e.value&&(e.value.height=h,e.value.width=i,s=e.value.getContext("2d"),s&&(u.value=new St({canvasRenderingContext2D:s,canvasDimensions:{width:i,height:h},lightSpeed:20}),setInterval(()=>{u.value&&u.value.run()},10))),window.addEventListener("resize",()=>{e.value&&(e.value.height=window.innerHeight,e.value.width=window.innerWidth),u.value&&(u.value.canvasDimensions={width:window.innerWidth,height:window.innerHeight})})});function c(m){var d;u&&((d=u.value)==null||d.moveLightTarget(m))}return(m,d)=>(x(),D("canvas",{ref:(_,S)=>{S.canvas=_,e.value=_},onPointermove:d[0]||(d[0]=_=>c(_))},null,544))}});var Rt=B(wt,[["__scopeId","data-v-717dbd48"]]);const y=t=>(Q("data-v-b5c03d02"),t=t(),X(),t),Lt=y(()=>g("header",{class:"title"}," Schrodingballs ",-1)),Nt={class:"scoreResult"},At={key:0,class:"scoreResult__dead"},It={key:1,class:"scoreResult__alone"},Mt={key:2,class:"scoreResult__alive"},Ot={class:"menuForm"},bt={key:0,class:"menuForm__options"},Tt=y(()=>g("label",{for:"options__timeLimit",class:"option_label"},"Time:",-1)),kt=["value"],Et=y(()=>g("label",{for:"options__numberOfCats",class:"option_label"},"Number of cats:",-1)),Vt=["value"],Wt=y(()=>g("label",{for:"options__speedOfCats",class:"option_label"},"Speed of cats:",-1)),zt=["value"],Ft=y(()=>g("label",{for:"options__lightRadius",class:"option_label"},"Light radius:",-1)),Bt=["value"],Ut=y(()=>g("label",{for:"options__lightSpeed",class:"option_label"},"Light speed:",-1)),Kt=["value"],$t=y(()=>g("label",{for:"options__lightColor",class:"option_label"},"Light color:",-1)),qt={key:1,class:"description"},Gt=y(()=>g("div",null,"Darkness is not safe!",-1)),Pt=y(()=>g("div",null,"Save schrodinger cats by lighting them all up!",-1)),Ht=y(()=>g("div",null,"The only way to find out if a cat is dead is by looking at it",-1)),Yt=[Gt,Pt,Ht],jt={class:"menuForm__actions"},Jt=A({setup(t){let e=N(!1);function s(){e.value=!e.value}function h(r){const a=+r.target.value;n.numberOfCats=0,n.numberOfCats=Math.max(Math.min(a,3e3),5),u.value&&u.value.generateCats(n.numberOfCats)}function i(r){const a=+r.target.value;n.lightSpeed=0,n.lightSpeed=Math.max(Math.min(a,50),10)}function c(r){const a=+r.target.value;n.speedOfCats=0,n.speedOfCats=Math.max(Math.min(a,5),1)}function m(r){const a=+r.target.value;n.lightRadius=0,n.lightRadius=Math.max(Math.min(a,200),50)}function d(r){const a=+r.target.value;n.timeLimit=0,n.timeLimit=Math.max(Math.min(a,120),30),u.value&&u.value.setTimeLimit(n.timeLimit)}function _(){u.value&&u.value.render()}function S(r){u.value&&u.value.moveLightTarget(r)}function o(){if(R.play(),u.value){pt.play();const r=performance.now();n.gameStarted=!0,u.value.startingTime=performance.now(),u.value.generateCats(n.numberOfCats),u.value.cats.forEach(a=>a.lastWitnessAlive=r),u.value.bonuses=[]}}return(r,a)=>(x(),D("div",{class:"overlay",onPointermove:a[9]||(a[9]=l=>S(l))},[Lt,g("div",Nt,[f(n).lastScore===0?(x(),D("div",At," You saved no cats, better luck next time. ")):f(n).lastScore===1?(x(),D("div",It," You saved 1 cat, he feels lonely. ")):f(n).lastScore!==null?(x(),D("div",Mt," You saved "+k(f(n).lastScore)+" cats, hooray! ",1)):E("",!0)]),g("form",Ot,[f(e)?(x(),D("div",bt,[Tt,g("input",{id:"options__timeLimit",class:"option_input",type:"number",min:"30",max:"120",value:f(n).timeLimit,onChange:a[0]||(a[0]=l=>d(l))},null,40,kt),Et,g("input",{id:"options__numberOfCats",class:"option_input",type:"number",min:"5",max:"30",value:f(n).numberOfCats,onChange:a[1]||(a[1]=l=>h(l))},null,40,Vt),Wt,g("input",{id:"options__speedOfCats",class:"option_input",type:"number",step:"0.1",min:"1",max:"5",value:f(n).speedOfCats,onChange:a[2]||(a[2]=l=>c(l))},null,40,zt),Ft,g("input",{id:"options__lightRadius",class:"option_input",type:"number",min:"50",max:"200",value:f(n).lightRadius,onChange:a[3]||(a[3]=l=>m(l))},null,40,Bt),Ut,g("input",{id:"options__lightSpeed",class:"option_input",type:"number",min:"10",max:"50",value:f(n).lightSpeed,onChange:a[4]||(a[4]=l=>i(l))},null,40,Kt),$t,Y(g("input",{id:"options__lightColor",class:"option_input",type:"color","onUpdate:modelValue":a[5]||(a[5]=l=>f(n).lightColor=l),onInput:a[6]||(a[6]=l=>_())},null,544),[[j,f(n).lightColor]])])):(x(),D("div",qt,Yt)),g("div",jt,[g("input",{class:"menuForm__action",type:"button",value:"\u{1F4A1} Start",onClick:a[7]||(a[7]=l=>o())}),g("button",{class:"menuForm__action",onClick:a[8]||(a[8]=J(l=>s(),["prevent","stop"]))},"\u2699\uFE0F"+k(f(e)?"info":"settings"),1)])])],32))}});var Qt=B(Jt,[["__scopeId","data-v-b5c03d02"]]);const Xt=A({setup(t){return(e,s)=>(x(),D(et,null,[f(n).gameStarted?E("",!0):(x(),Z(Qt,{key:0})),tt(Rt)],64))}});it(Xt).mount("#app");

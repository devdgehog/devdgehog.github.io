var E=Object.defineProperty,W=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var S=(t,e,a)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,N=(t,e)=>{for(var a in e||(e={}))K.call(e,a)&&S(t,a,e[a]);if(w)for(var a of w(e))B.call(e,a)&&S(t,a,e[a]);return t},M=(t,e)=>W(t,U(e));var _=(t,e,a)=>(S(t,typeof e!="symbol"?e+"":e,a),a);import{r as F,a as O,d as R,o as z,b as x,c as y,e as h,u as g,t as $,f as I,w as q,v as G,p as P,g as Y,h as j,i as H,F as J,j as Q}from"./vendor.c93ea60d.js";const X=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function a(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(i){if(i.ep)return;i.ep=!0;const r=a(i);fetch(i.href,r)}};X();const n=F({timeLimit:60,numberOfCats:5,speedOfCats:2,lightRadius:100,lightSpeed:20,lightColor:"#ffffff",gameStarted:!1,lastScore:null}),Z={effect:t=>{n.lightRadius*=t},value:2,positive:!0,resetValue:.5,duration:5e3},tt={effect:t=>{n.lightSpeed*=t},value:2,positive:!0,resetValue:.5,duration:5e3},et={effect:()=>{var t;(t=d.value)==null||t.addCat()},value:1,positive:!0},it={effect:t=>{var e;(e=d.value)==null||e.setTimeLimit(d.value.timeLimit-t)},value:3,positive:!0},nt={effect:t=>{n.lightRadius*=t},value:.5,positive:!1,resetValue:2,duration:5e3},st={effect:t=>{n.lightSpeed*=t},value:.5,positive:!1,resetValue:2,duration:5e3},ot={effect:t=>{n.lightSpeed*=t},value:.001,positive:!1,resetValue:1e3,duration:500},T=[Z,tt,et,it,nt,st,ot];function at(t){t.effect(t.value),console.log(t.duration),t.duration&&(t.timeoutId=setTimeout(()=>{t.resetValue&&t.effect(t.resetValue),clearTimeout(t.timeoutId),t.timeoutId=void 0},t.duration))}function A(t){return t.x*t.x+t.y*t.y}function k(t,e){return A({x:e.x-t.x,y:e.y-t.y})}function rt(t,e,a){const l={x:e.x-t.position.x,y:e.y-t.position.y},i=A(l);if(i<a*a)t.position.x=e.x,t.position.y=e.y;else{const r=Math.sqrt(i);t.position.x+=a*l.x/r,t.position.y+=a*l.y/r}return t}function b(t){return t.target&&rt(t,t.target,t.getSpeed()),t}var p;(function(t){t.ALIVE="alive",t.DEAD="dead"})(p||(p={}));var v;(function(t){t.ALIVE_UNKNOWN="alive_unknown",t.DEAD_UNKNOWN="dead_unknown"})(v||(v={}));function lt(t){return t.schrodingerState===v.ALIVE_UNKNOWN?t.schrodingerState=p.ALIVE:t.schrodingerState===v.DEAD_UNKNOWN&&(t.schrodingerState=p.DEAD),t}function ct(t,e){return t.schrodingerState=e,t}function dt(t){return t.schrodingerState!==p.DEAD&&performance.now()>t.lastWitnessAlive+t.invulnerableTime&&ct(t,v.DEAD_UNKNOWN),t}function ut(t){return lt(t),t.schrodingerState===p.ALIVE&&(t.lastWitnessAlive=performance.now()),t}const L=new Image(62,59);L.src="/src/assets/eye.png";const D=new Image(355,256);D.src="/src/assets/cat.png";const d=O(null);class ht{constructor(e){_(this,"canvasRenderingContext2D");_(this,"canvasDimensions");_(this,"cats",[]);_(this,"bonuses",[]);_(this,"light");_(this,"startingTime");_(this,"timeLimit");this.canvasRenderingContext2D=e.canvasRenderingContext2D,this.canvasDimensions=e.canvasDimensions,this.startingTime=performance.now(),this.light={position:{x:.5*e.canvasDimensions.width,y:.5*e.canvasDimensions.height},target:{x:.5*e.canvasDimensions.width,y:.5*e.canvasDimensions.height},getRadius:()=>n.lightRadius,getSpeed:()=>n.lightSpeed},this.timeLimit=n.timeLimit,this.generateCats(n.numberOfCats)}setTimeLimit(e){this.timeLimit=e}generateCats(e){const a=[],l=performance.now();for(let i=0;i<e;++i)a.push({id:i,position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},sprite:"",size:50,schrodingerState:v.ALIVE_UNKNOWN,lastWitnessAlive:l,invulnerableTime:2e3+Math.random()*2e3,getSpeed:()=>n.speedOfCats,clock:l,internalClockReset:Math.random()*2e3+1e3});this.cats=a}addCat(){const e=performance.now();this.cats.push({id:this.cats.length,position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},sprite:"",size:50,schrodingerState:v.ALIVE_UNKNOWN,lastWitnessAlive:e,invulnerableTime:2e3+Math.random()*2e3,getSpeed:()=>n.speedOfCats,clock:e,internalClockReset:Math.random()*2e3+1e3})}moveCats(){for(const e of this.cats)b(e)}run(){const e=performance.now();if(this.cats.filter(i=>i.schrodingerState===p.ALIVE||i.schrodingerState===v.ALIVE_UNKNOWN||i.schrodingerState===v.DEAD_UNKNOWN).length===0||n.gameStarted&&n.timeLimit-(e-this.startingTime)/1e3<0){n.gameStarted=!1,n.lastScore=this.cats.filter(i=>i.schrodingerState===p.ALIVE||i.schrodingerState===v.ALIVE_UNKNOWN).length;for(const i of this.bonuses)i.timeoutId&&i.resetValue&&(i.effect(i.resetValue),clearTimeout(i.timeoutId),i.timeoutId=void 0)}b(this.light);for(const i of this.cats)e>i.clock+i.internalClockReset&&(i.clock=e,i.target={x:Math.random()*this.canvasDimensions.width,y:Math.random()*this.canvasDimensions.height});const l=this.bonuses.filter(i=>!i.triggered);if(n.gameStarted){const i=this.light.getRadius(),r=i*i;for(const c of this.cats)k(this.light.position,c.position)<r?ut(c):dt(c);for(const c of l)k(this.light.position,c.position)<r&&(at(c),c.triggered=!0)}for(const i of l)e>i.clock+i.stayOnFieldDuration&&(i.triggered=!0);this.moveCats(),Math.random()<.002&&this.bonuses.push(M(N({},T[Math.floor(Math.random()*T.length)]),{position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},clock:e,stayOnFieldDuration:3e3+2e3*Math.random(),triggered:!1})),this.render()}moveLightTarget(e){this.light.target={x:e.x,y:e.y}}render(){const e=n.lightColor,a="black";this.canvasRenderingContext2D.fillStyle=e,this.canvasRenderingContext2D.fillRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height);const l=this.cats.filter(o=>o.schrodingerState!==p.DEAD),i=this.bonuses.filter(o=>!o.triggered);for(const o of l){const s=o.size,u=D.width/D.height;this.canvasRenderingContext2D.drawImage(D,o.position.x-.5*s*u,o.position.y-.5*s,s*u,s)}for(const o of i)o.positive?this.canvasRenderingContext2D.fillStyle="green":this.canvasRenderingContext2D.fillStyle="orange",this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(o.position.x,o.position.y,20,0,2*Math.PI),this.canvasRenderingContext2D.fill();const r=this.light.position.x,c=this.light.position.y,f=this.light.getRadius();this.canvasRenderingContext2D.fillStyle=a,this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(r,c,.99*f,0,2*Math.PI),this.canvasRenderingContext2D.rect(this.canvasDimensions.width,0,-this.canvasDimensions.width,this.canvasDimensions.height),this.canvasRenderingContext2D.fill();const m=this.canvasRenderingContext2D.createRadialGradient(r,c,0,r,c,f);m.addColorStop(0,"rgba(0, 0, 0, 0)"),m.addColorStop(1,"rgba(0, 0, 0, 1)"),this.canvasRenderingContext2D.fillStyle=m,this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(r,c,f,0,2*Math.PI),this.canvasRenderingContext2D.fill(),this.canvasRenderingContext2D.font="30px Arial";for(const o of i)o.positive?this.canvasRenderingContext2D.fillStyle="lime":this.canvasRenderingContext2D.fillStyle="red",this.canvasRenderingContext2D.fillText("!",o.position.x-5,o.position.y+10);for(const o of l){const s=.3*o.size;this.canvasRenderingContext2D.drawImage(L,o.position.x-s+.1*s,o.position.y-.1*o.size,s,s),this.canvasRenderingContext2D.drawImage(L,o.position.x+s-.7*s,o.position.y-.15*o.size,s,s)}this.canvasRenderingContext2D.font="30px Arial",this.canvasRenderingContext2D.fillStyle="yellow",n.gameStarted?this.canvasRenderingContext2D.fillText(`Time: ${(n.timeLimit-(performance.now()-this.startingTime)/1e3).toFixed(1)}s`,5,30):this.canvasRenderingContext2D.fillText(`Time: ${n.timeLimit.toFixed(1)}s`,5,30)}}var V=(t,e)=>{for(const[a,l]of e)t[a]=l;return t};const gt=R({setup(t){const e=O(null);let a=null;const l=window.innerHeight,i=window.innerWidth;z(()=>{e.value&&(e.value.height=l,e.value.width=i,a=e.value.getContext("2d"),a&&(d.value=new ht({canvasRenderingContext2D:a,canvasDimensions:{width:i,height:l},lightSpeed:20}),setInterval(()=>{d.value&&d.value.run()},10)))});function r(c){var f;d&&((f=d.value)==null||f.moveLightTarget(c))}return(c,f)=>(x(),y("canvas",{ref:(m,o)=>{o.canvas=m,e.value=m},onPointermove:f[0]||(f[0]=m=>r(m))},null,544))}});var ft=V(gt,[["__scopeId","data-v-2014746e"]]);const C=t=>(P("data-v-1ef17b74"),t=t(),Y(),t),mt=C(()=>h("header",{class:"title"}," Schrodingballs ",-1)),vt={class:"scoreResult"},pt={key:0,class:"scoreResult__dead"},_t={key:1,class:"scoreResult__alone"},xt={key:2,class:"scoreResult__alive"},Ct={class:"menuForm"},yt={class:"menuForm__options"},Dt=C(()=>h("label",{for:"options__timeLimit",class:"option_label"},"Time:",-1)),St=["value"],Rt=C(()=>h("label",{for:"options__numberOfCats",class:"option_label"},"Number of cats:",-1)),Lt=["value"],wt=C(()=>h("label",{for:"options__speedOfCats",class:"option_label"},"Speed of cats:",-1)),Nt=["value"],Mt=C(()=>h("label",{for:"options__lightRadius",class:"option_label"},"Light radius:",-1)),Ot=["value"],It=C(()=>h("label",{for:"options__lightSpeed",class:"option_label"},"Light speed:",-1)),Tt=["value"],At=C(()=>h("label",{for:"options__lightColor",class:"option_label"},"Light color:",-1)),kt=R({setup(t){function e(o){const s=+o.target.value;n.numberOfCats=0,n.numberOfCats=Math.max(Math.min(s,3e3),5),d.value&&d.value.generateCats(n.numberOfCats)}function a(o){const s=+o.target.value;n.lightSpeed=0,n.lightSpeed=Math.max(Math.min(s,50),10)}function l(o){const s=+o.target.value;n.speedOfCats=0,n.speedOfCats=Math.max(Math.min(s,5),1)}function i(o){const s=+o.target.value;n.lightRadius=0,n.lightRadius=Math.max(Math.min(s,200),50)}function r(o){const s=+o.target.value;n.timeLimit=0,n.timeLimit=Math.max(Math.min(s,120),30),d.value&&d.value.setTimeLimit(n.timeLimit)}function c(){d.value&&d.value.render()}function f(o){d.value&&d.value.moveLightTarget(o)}function m(){if(d.value){const o=performance.now();n.gameStarted=!0,d.value.startingTime=performance.now(),d.value.generateCats(n.numberOfCats),d.value.cats.forEach(s=>s.lastWitnessAlive=o),d.value.bonuses=[]}}return(o,s)=>(x(),y("div",{class:"overlay",onPointermove:s[8]||(s[8]=u=>f(u))},[mt,h("div",vt,[g(n).lastScore===0?(x(),y("div",pt," You saved no cats, better luck next time. ")):g(n).lastScore===1?(x(),y("div",_t," You saved 1 cat, he feels lonely. ")):g(n).lastScore!==null?(x(),y("div",xt," You saved "+$(g(n).lastScore)+" cats, hooray! ",1)):I("",!0)]),h("form",Ct,[h("div",yt,[Dt,h("input",{id:"options__timeLimit",class:"option_input",type:"number",min:"30",max:"120",value:g(n).timeLimit,onChange:s[0]||(s[0]=u=>r(u))},null,40,St),Rt,h("input",{id:"options__numberOfCats",class:"option_input",type:"number",min:"5",max:"30",value:g(n).numberOfCats,onChange:s[1]||(s[1]=u=>e(u))},null,40,Lt),wt,h("input",{id:"options__speedOfCats",class:"option_input",type:"number",step:"0.1",min:"1",max:"5",value:g(n).speedOfCats,onChange:s[2]||(s[2]=u=>l(u))},null,40,Nt),Mt,h("input",{id:"options__lightRadius",class:"option_input",type:"number",min:"50",max:"200",value:g(n).lightRadius,onChange:s[3]||(s[3]=u=>i(u))},null,40,Ot),It,h("input",{id:"options__lightSpeed",class:"option_input",type:"number",min:"10",max:"50",value:g(n).lightSpeed,onChange:s[4]||(s[4]=u=>a(u))},null,40,Tt),At,q(h("input",{id:"options__lightColor",class:"option_input",type:"color","onUpdate:modelValue":s[5]||(s[5]=u=>g(n).lightColor=u),onInput:s[6]||(s[6]=u=>c())},null,544),[[G,g(n).lightColor]])]),h("input",{class:"menuForm__start",type:"button",value:"Start",onClick:s[7]||(s[7]=u=>m())})])],32))}});var bt=V(kt,[["__scopeId","data-v-1ef17b74"]]);const Vt=R({setup(t){return(e,a)=>(x(),y(J,null,[g(n).gameStarted?I("",!0):(x(),j(bt,{key:0})),H(ft)],64))}});Q(Vt).mount("#app");

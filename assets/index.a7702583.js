var U=Object.defineProperty,K=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var L=(t,e,o)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,O=(t,e)=>{for(var o in e||(e={}))$.call(e,o)&&L(t,o,e[o]);if(M)for(var o of M(e))q.call(e,o)&&L(t,o,e[o]);return t},T=(t,e)=>K(t,F(e));var y=(t,e,o)=>(L(t,typeof e!="symbol"?e+"":e,o),o);import{r as G,a as b,d as N,o as P,b as x,c as S,e as h,u as m,t as H,f as E,w as Y,v as j,p as J,g as Q,h as X,i as Z,F as tt,j as et}from"./vendor.c93ea60d.js";const it=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const g of r.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&d(g)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function d(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}};it();const s=G({timeLimit:60,numberOfCats:5,speedOfCats:2,lightRadius:100,lightSpeed:20,lightColor:"#ffffff",gameStarted:!1,lastScore:null}),nt={effect:t=>{s.lightRadius*=t},value:2,positive:!0,resetValue:.5,duration:5e3},st={effect:t=>{s.lightSpeed*=t},value:2,positive:!0,resetValue:.5,duration:5e3},ot={effect:()=>{var t;(t=c.value)==null||t.addCat()},value:1,positive:!0},at={effect:t=>{var e;(e=c.value)==null||e.setTimeLimit(c.value.timeLimit-t)},value:3,positive:!0},rt={effect:t=>{s.lightRadius*=t},value:.5,positive:!1,resetValue:2,duration:5e3},lt={effect:t=>{s.lightSpeed*=t},value:.5,positive:!1,resetValue:2,duration:5e3},ct={effect:t=>{s.lightSpeed*=t},value:.001,positive:!1,resetValue:1e3,duration:500},k=[nt,st,ot,at,rt,lt,ct];function dt(t){t.effect(t.value),console.log(t.duration),t.duration&&(t.timeoutId=setTimeout(()=>{t.resetValue&&t.effect(t.resetValue),clearTimeout(t.timeoutId),t.timeoutId=void 0},t.duration))}function V(t){return t.x*t.x+t.y*t.y}function W(t,e){return V({x:e.x-t.x,y:e.y-t.y})}function ut(t,e,o){const d={x:e.x-t.position.x,y:e.y-t.position.y},n=V(d);if(n<o*o)t.position.x=e.x,t.position.y=e.y;else{const r=Math.sqrt(n);t.position.x+=o*d.x/r,t.position.y+=o*d.y/r}return t}function z(t){return t.target&&ut(t,t.target,t.getSpeed()),t}var f;(function(t){t.ALIVE="alive",t.DEAD="dead"})(f||(f={}));var p;(function(t){t.ALIVE_UNKNOWN="alive_unknown",t.DEAD_UNKNOWN="dead_unknown"})(p||(p={}));function ht(t){return t.schrodingerState===p.ALIVE_UNKNOWN?t.schrodingerState=f.ALIVE:t.schrodingerState===p.DEAD_UNKNOWN&&(t.schrodingerState=f.DEAD),t}function gt(t,e){return t.schrodingerState=e,t}const mt=new Audio("/src/assets/sweet-kitty.mp3"),ft=new Audio("/src/assets/space-impact.mp3"),R=new Audio("/src/assets/night-ambiance.mp3");R.volume=.15;R.loop=!0;function pt(t){return t.schrodingerState!==f.DEAD&&performance.now()>t.lastWitnessAlive+t.invulnerableTime&&gt(t,p.DEAD_UNKNOWN),t}function vt(t){return ht(t),t.schrodingerState===f.ALIVE&&(t.lastWitnessAlive=performance.now()),t}const A=new Image(62,59);A.src="/src/assets/eye.png";const C=new Image(355,256);C.src="/src/assets/cat.png";const I=new Image(62,59);I.src="/src/assets/eye_crossed.png";const _t=new Audio("/src/assets/positive-bonus.mp3"),yt=new Audio("/src/assets/negative-bonus.mp3"),xt=new Audio("/src/assets/spawn-bonus.mp3"),Ct=new Audio("/src/assets/angry-kitty.mp3"),c=b(null);class Dt{constructor(e){y(this,"canvasRenderingContext2D");y(this,"canvasDimensions");y(this,"cats",[]);y(this,"bonuses",[]);y(this,"light");y(this,"startingTime");y(this,"timeLimit");this.canvasRenderingContext2D=e.canvasRenderingContext2D,this.canvasDimensions=e.canvasDimensions,this.startingTime=performance.now(),this.light={position:{x:.5*e.canvasDimensions.width,y:.5*e.canvasDimensions.height},target:{x:.5*e.canvasDimensions.width,y:.5*e.canvasDimensions.height},getRadius:()=>s.lightRadius,getSpeed:()=>s.lightSpeed},this.timeLimit=s.timeLimit,this.generateCats(s.numberOfCats)}setTimeLimit(e){this.timeLimit=e}generateCats(e){const o=[],d=performance.now();for(let n=0;n<e;++n)o.push({id:n,position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},sprite:"",size:50,schrodingerState:p.ALIVE_UNKNOWN,lastWitnessAlive:d,invulnerableTime:3e3+Math.random()*3e3,getSpeed:()=>s.speedOfCats,clock:d,internalClockReset:Math.random()*2e3+1e3});this.cats=o}addCat(){const e=performance.now();this.cats.push({id:this.cats.length,position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},sprite:"",size:50,schrodingerState:p.ALIVE_UNKNOWN,lastWitnessAlive:e,invulnerableTime:4e3+Math.random()*1e3,getSpeed:()=>s.speedOfCats,clock:e,internalClockReset:Math.random()*2e3+1e3})}moveCats(){const e=this.cats.filter(o=>o.schrodingerState!==f.DEAD);for(const o of e)z(o)}run(){const e=performance.now(),o=this.cats.filter(n=>n.schrodingerState===f.ALIVE||n.schrodingerState===p.ALIVE_UNKNOWN||n.schrodingerState===p.DEAD_UNKNOWN).length;if(s.gameStarted&&o===0||s.gameStarted&&s.timeLimit-(e-this.startingTime)/1e3<0){s.gameStarted=!1,R.pause(),R.currentTime=0,mt.play(),s.lastScore=this.cats.filter(n=>n.schrodingerState===f.ALIVE||n.schrodingerState===p.ALIVE_UNKNOWN).length;for(const n of this.bonuses)n.timeoutId&&n.resetValue&&(n.effect(n.resetValue),clearTimeout(n.timeoutId),n.timeoutId=void 0)}z(this.light);for(const n of this.cats)e>n.clock+n.internalClockReset&&(n.clock=e,n.target={x:Math.random()*this.canvasDimensions.width,y:Math.random()*this.canvasDimensions.height});const d=this.bonuses.filter(n=>!n.triggered);if(s.gameStarted){const n=this.light.getRadius(),r=n*n,g=this.cats.filter(l=>l.schrodingerState!==f.DEAD);for(const l of g)W(this.light.position,l.position)<r?(l.schrodingerState===p.DEAD_UNKNOWN&&Ct.play(),vt(l)):pt(l);for(const l of d)W(this.light.position,l.position)<r&&(l.positive?_t.play():yt.play(),dt(l),l.triggered=!0)}for(const n of d)e>n.clock+n.stayOnFieldDuration&&(n.triggered=!0);this.moveCats(),Math.random()<.002&&(s.gameStarted&&xt.play(),this.bonuses.push(T(O({},k[Math.floor(Math.random()*k.length)]),{position:{x:this.canvasDimensions.width*Math.random(),y:this.canvasDimensions.height*Math.random()},clock:e,stayOnFieldDuration:3e3+2e3*Math.random(),triggered:!1}))),this.render()}moveLightTarget(e){this.light.target={x:e.x,y:e.y}}render(){const e=s.lightColor,o="rgb(0, 0, 0, 0.95)";this.canvasRenderingContext2D.fillStyle=e,this.canvasRenderingContext2D.fillRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height);const d=this.cats.filter(i=>i.schrodingerState===f.DEAD),n=this.cats.filter(i=>i.schrodingerState!==f.DEAD),r=this.bonuses.filter(i=>!i.triggered);for(const i of d){const a=i.size,w=C.width/C.height;this.canvasRenderingContext2D.drawImage(C,i.position.x-.5*a*w,i.position.y-.5*a,a*w,a);const _=.3*i.size;this.canvasRenderingContext2D.drawImage(I,i.position.x-_+.1*_,i.position.y-.1*i.size,_,_),this.canvasRenderingContext2D.drawImage(I,i.position.x+_-.7*_,i.position.y-.15*i.size,_,_)}for(const i of n){const a=i.size,w=C.width/C.height;this.canvasRenderingContext2D.drawImage(C,i.position.x-.5*a*w,i.position.y-.5*a,a*w,a)}for(const i of r)i.positive?this.canvasRenderingContext2D.fillStyle="green":this.canvasRenderingContext2D.fillStyle="orange",this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(i.position.x,i.position.y,20,0,2*Math.PI),this.canvasRenderingContext2D.fill();const g=this.light.position.x,l=this.light.position.y,v=this.light.getRadius();this.canvasRenderingContext2D.fillStyle=o,this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(g,l,.99*v,0,2*Math.PI),this.canvasRenderingContext2D.rect(this.canvasDimensions.width,0,-this.canvasDimensions.width,this.canvasDimensions.height),this.canvasRenderingContext2D.fill();const u=this.canvasRenderingContext2D.createRadialGradient(g,l,0,g,l,v);u.addColorStop(0,"rgba(0, 0, 0, 0)"),u.addColorStop(1,"rgba(0, 0, 0, 0.8)"),this.canvasRenderingContext2D.fillStyle=u,this.canvasRenderingContext2D.beginPath(),this.canvasRenderingContext2D.arc(g,l,v,0,2*Math.PI),this.canvasRenderingContext2D.fill(),this.canvasRenderingContext2D.font="30px Arial";for(const i of r)i.positive?this.canvasRenderingContext2D.fillStyle="lime":this.canvasRenderingContext2D.fillStyle="red",this.canvasRenderingContext2D.fillText("!",i.position.x-5,i.position.y+10);for(const i of n){const a=.3*i.size;this.canvasRenderingContext2D.drawImage(A,i.position.x-a+.1*a,i.position.y-.1*i.size,a,a),this.canvasRenderingContext2D.drawImage(A,i.position.x+a-.7*a,i.position.y-.15*i.size,a,a)}this.canvasRenderingContext2D.font="30px Arial",this.canvasRenderingContext2D.fillStyle="yellow",s.gameStarted?this.canvasRenderingContext2D.fillText(`Time: ${(s.timeLimit-(performance.now()-this.startingTime)/1e3).toFixed(1)}s`,5,30):this.canvasRenderingContext2D.fillText(`Time: ${s.timeLimit.toFixed(1)}s`,5,30)}}var B=(t,e)=>{for(const[o,d]of e)t[o]=d;return t};const St=N({setup(t){const e=b(null);let o=null;const d=window.innerHeight,n=window.innerWidth;P(()=>{e.value&&(e.value.height=d,e.value.width=n,o=e.value.getContext("2d"),o&&(c.value=new Dt({canvasRenderingContext2D:o,canvasDimensions:{width:n,height:d},lightSpeed:20}),setInterval(()=>{c.value&&c.value.run()},10))),window.addEventListener("resize",()=>{e.value&&(e.value.height=window.innerHeight,e.value.width=window.innerWidth),c.value&&(c.value.canvasDimensions={width:window.innerWidth,height:window.innerHeight})})});function r(g){var l;c&&((l=c.value)==null||l.moveLightTarget(g))}return(g,l)=>(x(),S("canvas",{ref:(v,u)=>{u.canvas=v,e.value=v},onPointermove:l[0]||(l[0]=v=>r(v))},null,544))}});var wt=B(St,[["__scopeId","data-v-717dbd48"]]);const D=t=>(J("data-v-a7596d32"),t=t(),Q(),t),Rt=D(()=>h("header",{class:"title"}," Schrodingballs ",-1)),Lt={class:"scoreResult"},Nt={key:0,class:"scoreResult__dead"},At={key:1,class:"scoreResult__alone"},It={key:2,class:"scoreResult__alive"},Mt={class:"menuForm"},Ot={class:"menuForm__options"},Tt=D(()=>h("label",{for:"options__timeLimit",class:"option_label"},"Time:",-1)),bt=["value"],Et=D(()=>h("label",{for:"options__numberOfCats",class:"option_label"},"Number of cats:",-1)),kt=["value"],Vt=D(()=>h("label",{for:"options__speedOfCats",class:"option_label"},"Speed of cats:",-1)),Wt=["value"],zt=D(()=>h("label",{for:"options__lightRadius",class:"option_label"},"Light radius:",-1)),Bt=["value"],Ut=D(()=>h("label",{for:"options__lightSpeed",class:"option_label"},"Light speed:",-1)),Kt=["value"],Ft=D(()=>h("label",{for:"options__lightColor",class:"option_label"},"Light color:",-1)),$t=N({setup(t){function e(u){const i=+u.target.value;s.numberOfCats=0,s.numberOfCats=Math.max(Math.min(i,3e3),5),c.value&&c.value.generateCats(s.numberOfCats)}function o(u){const i=+u.target.value;s.lightSpeed=0,s.lightSpeed=Math.max(Math.min(i,50),10)}function d(u){const i=+u.target.value;s.speedOfCats=0,s.speedOfCats=Math.max(Math.min(i,5),1)}function n(u){const i=+u.target.value;s.lightRadius=0,s.lightRadius=Math.max(Math.min(i,200),50)}function r(u){const i=+u.target.value;s.timeLimit=0,s.timeLimit=Math.max(Math.min(i,120),30),c.value&&c.value.setTimeLimit(s.timeLimit)}function g(){c.value&&c.value.render()}function l(u){c.value&&c.value.moveLightTarget(u)}function v(){if(R.play(),c.value){ft.play();const u=performance.now();s.gameStarted=!0,c.value.startingTime=performance.now(),c.value.generateCats(s.numberOfCats),c.value.cats.forEach(i=>i.lastWitnessAlive=u),c.value.bonuses=[]}}return(u,i)=>(x(),S("div",{class:"overlay",onPointermove:i[8]||(i[8]=a=>l(a))},[Rt,h("div",Lt,[m(s).lastScore===0?(x(),S("div",Nt," You saved no cats, better luck next time. ")):m(s).lastScore===1?(x(),S("div",At," You saved 1 cat, he feels lonely. ")):m(s).lastScore!==null?(x(),S("div",It," You saved "+H(m(s).lastScore)+" cats, hooray! ",1)):E("",!0)]),h("form",Mt,[h("div",Ot,[Tt,h("input",{id:"options__timeLimit",class:"option_input",type:"number",min:"30",max:"120",value:m(s).timeLimit,onChange:i[0]||(i[0]=a=>r(a))},null,40,bt),Et,h("input",{id:"options__numberOfCats",class:"option_input",type:"number",min:"5",max:"30",value:m(s).numberOfCats,onChange:i[1]||(i[1]=a=>e(a))},null,40,kt),Vt,h("input",{id:"options__speedOfCats",class:"option_input",type:"number",step:"0.1",min:"1",max:"5",value:m(s).speedOfCats,onChange:i[2]||(i[2]=a=>d(a))},null,40,Wt),zt,h("input",{id:"options__lightRadius",class:"option_input",type:"number",min:"50",max:"200",value:m(s).lightRadius,onChange:i[3]||(i[3]=a=>n(a))},null,40,Bt),Ut,h("input",{id:"options__lightSpeed",class:"option_input",type:"number",min:"10",max:"50",value:m(s).lightSpeed,onChange:i[4]||(i[4]=a=>o(a))},null,40,Kt),Ft,Y(h("input",{id:"options__lightColor",class:"option_input",type:"color","onUpdate:modelValue":i[5]||(i[5]=a=>m(s).lightColor=a),onInput:i[6]||(i[6]=a=>g())},null,544),[[j,m(s).lightColor]])]),h("input",{class:"menuForm__start",type:"button",value:"Start",onClick:i[7]||(i[7]=a=>v())})])],32))}});var qt=B($t,[["__scopeId","data-v-a7596d32"]]);const Gt=N({setup(t){return(e,o)=>(x(),S(tt,null,[m(s).gameStarted?E("",!0):(x(),X(qt,{key:0})),Z(wt)],64))}});et(Gt).mount("#app");
